---
import ReactCRT from "./CRT.tsx";

interface Props {
  scale?: number;
  slope?: number;
  intercept?: number;
}

const { scale = 100, slope = 0.8, intercept = 0.1 } = Astro.props;
---

<ReactCRT client:load scale={scale} slope={slope} intercept={intercept}>
  <slot />
</ReactCRT>

<style is:global>
  .crt-screen {
    --border-width: 0rem;
    contain: layout style paint;
    position: relative;
    box-sizing: border-box;
    width: calc(100vw - var(--border-width));
    height: calc(100vh - var(--border-width));
    overflow: hidden;
    border-radius: 0.25rem;
  }

  .crt-content {
    color: #010101;
    height: 100%;
    width: 100%;
    padding: 1rem;
    overflow-y: auto;
    box-sizing: border-box;
    position: relative;
    background: var(--bg-primary);
    z-index: 1;
  }

  .crt-content.crt-scanlines::after {
    content: "";
    pointer-events: none;
    position: fixed;
    top: -10%;
    left: -10%;
    width: 120%;
    height: 120%;
    --scanline-color: #2c2c2c;
    --scanline-weight: 4px;
    background: repeating-linear-gradient(
      0deg,
      transparent 0px,
      transparent var(--scanline-weight),
      var(--scanline-color) var(--scanline-weight),
      var(--scanline-color) calc(var(--scanline-weight) * 2)
    );
    opacity: 0.05;
    z-index: 999999;
  }

  .crt-filter-enabled {
    filter: url(#fisheye-filter);
    transform: translate3d(0, 0, 0);
    will-change: transform;
  }
</style>
